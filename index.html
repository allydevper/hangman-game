<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juego de Ahorcado</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@300..700&family=Fredoka:wght@300..700&family=Signika:wght@300..700&family=Work+Sans:ital,wght@0,100..900;1,100..900&display=swap"
        rel="stylesheet">
    <style>
        body {
            background-color: #1DB954;
            color: #191414;
            font-family: "Comfortaa", serif;
        }

        .keyboard {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 5px;
            margin-top: 20px;
        }

        .incorrect-letters-background {
            font-weight: bold;
            padding: 10px;
            background-color: white;
        }

        .message-background {
            font-weight: bold;
            padding: 10px;
            background-color: black;
        }

        .key {
            padding: 10px;
            font-size: 16px;
            cursor: pointer;
        }

        .marked-key {
            background-color: black;
            color: white;
        }

        .floating-combo {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
        }
    </style>
</head>

<body>
    <div class="floating-combo">
        <label for="language-select" class="text-white">Selecciona el idioma:</label>
        <select id="language-select" class="form-select mx-auto">
            <option value="es" selected>Español</option>
            <option value="en">Ingles</option>
            <option value="de">Alemán</option>
            <option value="it">Italiano</option>
            <option value="fr">Francés</option>
        </select>
    </div>
    <div class="container text-center mt-5">
        <h1 class="text-white" id="game-title">Juego de Ahorcado <span id="level-badge"
                class="position-absolute badge rounded-pill bg-danger fs-6">Nivel
                1</span></h1>
        <div id="word" class="my-4 fs-3">_ _ _ _ _</div>
        <span id="incorrect-letters" class="text-danger my-4"></span>
        <span id="message" class="my-4 text-warning"></span>
        <div id="attempts" class="text-white my-4">Intentos restantes: 6</div>

        <div class="keyboard" id="keyboard">
            <button class="key btn btn-light" data-key="Q">Q</button>
            <button class="key btn btn-light" data-key="W">W</button>
            <button class="key btn btn-light" data-key="E">E</button>
            <button class="key btn btn-light" data-key="R">R</button>
            <button class="key btn btn-light" data-key="T">T</button>
            <button class="key btn btn-light" data-key="Y">Y</button>
            <button class="key btn btn-light" data-key="U">U</button>
            <button class="key btn btn-light" data-key="I">I</button>
            <button class="key btn btn-light" data-key="O">O</button>
            <button class="key btn btn-light" data-key="P">P</button>
            <button class="key btn btn-light" data-key="A">A</button>
            <button class="key btn btn-light" data-key="S">S</button>
            <button class="key btn btn-light" data-key="D">D</button>
            <button class="key btn btn-light" data-key="F">F</button>
            <button class="key btn btn-light" data-key="G">G</button>
            <button class="key btn btn-light" data-key="H">H</button>
            <button class="key btn btn-light" data-key="J">J</button>
            <button class="key btn btn-light" data-key="K">K</button>
            <button class="key btn btn-light" data-key="L">L</button>
            <button class="key btn btn-light" data-key="Z">Z</button>
            <span></span>
            <span></span>
            <button class="key btn btn-light" data-key="X">X</button>
            <button class="key btn btn-light" data-key="C">C</button>
            <button class="key btn btn-light" data-key="V">V</button>
            <button class="key btn btn-light" data-key="B">B</button>
            <button class="key btn btn-light" data-key="N">N</button>
            <button class="key btn btn-light" data-key="M">M</button>
        </div>
        <div class="text-center mt-4">
            <button id="reload-level" class="btn btn-primary" onclick="reloadLevel();">Reiniciar nivel</button>
            <button id="next-level" class="btn btn-dark" onclick="nextLevel();">Siguiente nivel</button>
        </div>
    </div>

    <script>
        let word = '';
        let level = 1;
        let attempts = 6;
        let guessedLetters = [];
        let incorrectLetters = [];
        let gameOver = false;
        let gameFailed = false;
        let gameSuccess = false;

        const keys = document.querySelectorAll('.key');

        let selectedLanguage = 'es';

        const translations = {
            es: {
                gameTitle: 'Juego de Ahorcado',
                incorrectLetters: 'Letras incorrectas',
                remainingAttempts: 'Intentos restantes',
                winMessage: '¡Felicidades! Has adivinado la palabra.',
                loseMessage: 'Lo siento, has perdido. La palabra era: ',
                selectLanguage: 'Selecciona el idioma:',
                reloadLevel: 'Reiniciar nivel',
                nextLevel: 'Siguiente nivel',
                level: 'Nivel'
            },
            en: {
                gameTitle: 'Hangman Game',
                incorrectLetters: 'Incorrect letters',
                remainingAttempts: 'Remaining attempts',
                winMessage: 'Congratulations! You guessed the word.',
                loseMessage: 'Sorry, you lost. The word was: ',
                selectLanguage: 'Select Language:',
                reloadLevel: 'Reload level',
                nextLevel: 'Next level',
                level: 'level'
            },
            de: {
                gameTitle: 'Galgenmännchen-Spiel',
                incorrectLetters: 'Falsche Buchstaben',
                remainingAttempts: 'Verbleibende Versuche',
                winMessage: 'Herzlichen Glückwunsch! Du hast das Wort erraten.',
                loseMessage: 'Entschuldigung, du hast verloren. Das Wort war: ',
                selectLanguage: 'Sprache wählen:',
                reloadLevel: 'Level neu laden',
                nextLevel: 'Nächsten Level',
                level: 'Level'
            },
            it: {
                gameTitle: 'Gioco dell\'impiccato',
                incorrectLetters: 'Lettere sbagliate',
                remainingAttempts: 'Tentativi rimanenti',
                winMessage: 'Congratulazioni! Hai indovinato la parola.',
                loseMessage: 'Mi dispiace, hai perso. La parola era: ',
                selectLanguage: 'Seleziona la lingua:',
                reloadLevel: 'Ricarica livello',
                nextLevel: 'Prossimo livello',
                level: 'Livello'
            },
            fr: {
                gameTitle: 'Jeu du pendu',
                incorrectLetters: 'Lettres incorrectes',
                remainingAttempts: 'Tentatives restantes',
                winMessage: 'Félicitations! Vous avez deviné le mot.',
                loseMessage: 'Désolé, vous avez perdu. Le mot était : ',
                selectLanguage: 'Choisir la langue:',
                reloadLevel: 'Recharger le niveau',
                nextLevel: 'Niveau suivant',
                level: 'Niveau'
            }
        };

        function updateTexts() {
            const translation = translations[selectedLanguage];
            document.getElementById('game-title').innerHTML = `${translation.gameTitle} <span id="level-badge" class="position-absolute badge rounded-pill bg-danger fs-6">${translation.level} ${level}</span>`;
            document.getElementById('attempts').innerHTML = `${translation.remainingAttempts}: ${attempts}`;
            document.getElementById('reload-level').innerHTML = `${translation.reloadLevel}`;
            document.getElementById('next-level').innerHTML = `${translation.nextLevel}`;
            document.querySelector('label[for="language-select"]').innerHTML = translation.selectLanguage;
        }

        document.getElementById('language-select').addEventListener('change', updateLanguage);

        function updateLanguage() {
            debugger
            selectedLanguage = document.getElementById('language-select').value;

            nextLevel(0);
            updateTexts();
        }

        window.onload = function (event) {
            nextLevel(0);
        };

        function reloadLevel() {
            nextLevel(0);
        }

        function nextLevel(value = 1) {
            guessedLetters = [];
            incorrectLetters = [];
            level = level + value;
            attempts = 6;
            gameOver = false;
            gameFailed = false;
            gameSuccess = false;
            disableKeys();
            fetchWord();
            updateTexts();
            document.getElementById('next-level').setAttribute('disabled', 'disabled');
        }

        async function fetchWord() {
            try {
                const response = await fetch(`https://random-word-api.herokuapp.com/word?length=${4 + level}&lang=${selectedLanguage}`);
                const data = await response.json();
                word = normalize(data[0].toUpperCase());
                displayWord();
                enableKeys();
                document.getElementById('message').textContent = '';
                document.getElementById('message').classList.remove('message-background');

            } catch (error) {
                console.error('Error fetching word:', error);
            }
        }

        function displayWord() {
            const display = word.split('').map(letter => guessedLetters.includes(letter) ? letter : '_').join(' ');
            document.getElementById('word').textContent = display;
        }

        function checkGameStatus() {

            const translation = translations[selectedLanguage];

            if (incorrectLetters.length > 0) {
                document.getElementById('incorrect-letters').textContent = `${translation.incorrectLetters}: ` + incorrectLetters.join(', ');
                document.getElementById('incorrect-letters').classList.add('incorrect-letters-background');
            } else {
                document.getElementById('incorrect-letters').textContent = '';
                document.getElementById('incorrect-letters').classList.remove('incorrect-letters-background');
            }

            if (!document.getElementById('word').textContent.includes('_')) {
                document.getElementById('message').textContent = `${translation.winMessage}`;
                document.getElementById('message').classList.add('message-background');
                document.getElementById('incorrect-letters').textContent = '';
                document.getElementById('incorrect-letters').classList.remove('incorrect-letters-background');
                gameOver = true;
                gameSuccess = true;
                disableKeys();
                document.getElementById('next-level').removeAttribute('disabled');
            } else if (attempts <= 0) {
                document.getElementById('message').textContent = `${translation.loseMessage}` + word;
                document.getElementById('message').classList.add('message-background');
                document.getElementById('incorrect-letters').textContent = '';
                document.getElementById('incorrect-letters').classList.remove('incorrect-letters-background');
                gameOver = true;
                gameFailed = true;
                disableKeys();
            }
            updateTexts();
        }

        function disableKeys() {
            keys.forEach(key => {
                key.setAttribute('disabled', 'disabled');
                key.classList.remove('marked-key');
            });
        }

        function enableKeys() {
            keys.forEach(key => {
                key.removeAttribute('disabled');
                key.classList.remove('marked-key');
            });
        }

        keys.forEach(key => {
            key.addEventListener('click', () => {
                const guess = key.getAttribute('data-key');
                if (guess && !guessedLetters.includes(guess) && !incorrectLetters.includes(guess) && !gameOver) {
                    if (word.includes(guess)) {
                        guessedLetters.push(guess);
                    } else {
                        incorrectLetters.push(guess);
                        attempts--;
                    }
                    displayWord();
                    checkGameStatus();
                    key.classList.add('marked-key');
                }
            });
        });

        function normalize(word) {
            return word.normalize('NFKD').replace(/[\u0300-\u036f]/g, '');
        }

    </script>
</body>

</html>